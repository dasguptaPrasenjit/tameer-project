(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{yAJr:function(t,e,a){"use strict";a.r(e),a.d(e,"CategoryManagementModule",(function(){return W}));var i=a("ofXK"),r=a("tyNb"),o=a("fXoL"),c=a("M9IT"),s=a("+0xr"),n=a("Dh3D"),l=a("3Pt+"),d=a("0IaG"),b=a("vAVV"),m=a("UJjo"),g=a("XkPD"),u=a("Olgc"),p=a("r1eF"),h=a("SIeF"),f=a("kmnG"),y=a("qFsG"),v=a("W/tz"),S=a("pJxS"),C=a("bTqV"),_=a("NFeN"),X=a("Us6y");function w(t,e){if(1&t){const t=o.Zb();o.Yb(0,"span"),o.Gc(1),o.lc(2,"textTruncate"),o.Yb(3,"mat-icon",14),o.gc("click",(function(){return o.yc(t),o.kc().removeFile()})),o.Gc(4,"cancel"),o.Xb(),o.Xb()}if(2&t){const t=o.kc();var a;o.Gb(1),o.Ic(" ",o.nc(2,1,null==(a=t.form.get("category_image"))?null:a.value,15)," ")}}const Y=function(){return[".jpg",".jpeg",".png"]};let D=(()=>{class t{constructor(t,e,a,i,r,o,c){var s;this.dialogRef=t,this.modalData=e,this._formBuilder=a,this._CategoryService=i,this._ProgressBarService=r,this._UploaderService=o,this._ToastService=c,this.createForm(),(null===(s=this.modalData)||void 0===s?void 0:s.category)&&this.form.patchValue({name:this.modalData.category.categoryname,description:this.modalData.category.description,parentid:this.modalData.category.parent_id,category_image:this.modalData.category.category_image,slug:this.modalData.category.slug,meta_title:this.modalData.category.meta_title,meta_description:this.modalData.category.meta_description,meta_keywords:this.modalData.category.meta_keywords})}ngOnInit(){}createForm(){var t,e,a;this.form=this._formBuilder.group({name:["",l.v.required],description:["",l.v.required],parentid:[(null===(t=this.modalData)||void 0===t?void 0:t.parent)?null===(a=null===(e=this.modalData)||void 0===e?void 0:e.parent)||void 0===a?void 0:a.id:""],slug:["",l.v.required],meta_title:["",l.v.required],meta_description:["",l.v.required],meta_keywords:["",l.v.required],category_image:["",l.v.required]})}fileChanged(t){let e=new FormData;e.append("filenames[]",t.target.files[0]),e.append("type","category"),this._ProgressBarService.show(),this._UploaderService.upload(e).subscribe(t=>{this._ProgressBarService.hide(),t&&this.form.patchValue({category_image:t})})}removeFile(){this.form.patchValue({category_image:""})}submit(t){var e;if(t.preventDefault(),this.form.valid){this._ProgressBarService.show();const t=this.form.value;(null===(e=this.modalData)||void 0===e?void 0:e.category)?(t.id=this.modalData.category.id,this._CategoryService.updateCategory(t).subscribe(t=>{this._ProgressBarService.hide(),200===t.status?(this._ToastService.info(t.message),this.dialogRef.close(!0),this.form.reset()):this._ToastService.error(t.message)})):this._CategoryService.addCategory(t).subscribe(t=>{this._ProgressBarService.hide(),200===t.status?(this._ToastService.info(t.message),this.dialogRef.close(!0),this.form.reset()):this._ToastService.error(t.message)})}}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(d.g),o.Sb(d.a),o.Sb(l.d),o.Sb(b.a),o.Sb(m.a),o.Sb(g.a),o.Sb(u.a))},t.\u0275cmp=o.Mb({type:t,selectors:[["app-save-category"]],decls:30,vars:5,consts:[["autocomplete","off",3,"formGroup","submit"],[1,"row"],[1,"col-xs-12","col-md-6"],[1,"full-width"],["type","text","matInput","","placeholder","Category Name","formControlName","name"],["type","text","matInput","","placeholder","Slug","formControlName","slug"],["matInput","","placeholder","Category Description","formControlName","description"],["matInput","","placeholder","Meta Description","formControlName","meta_description"],[1,"col-xs-12","col-md-12"],["matInput","","placeholder","Meta Keywords","formControlName","meta_keywords"],["type","text","matInput","","placeholder","Meta Title","formControlName","meta_title"],[3,"fileTypes","change"],[4,"ngIf"],["mat-raised-button","","color","primary",3,"disabled","click"],[3,"click"]],template:function(t,e){if(1&t&&(o.Yb(0,"form",0),o.gc("submit",(function(t){return e.submit(t)})),o.Yb(1,"app-modal-header"),o.Gc(2,"Save Category"),o.Xb(),o.Yb(3,"app-modal-body"),o.Yb(4,"div",1),o.Yb(5,"div",2),o.Yb(6,"mat-form-field",3),o.Tb(7,"input",4),o.Xb(),o.Xb(),o.Yb(8,"div",2),o.Yb(9,"mat-form-field",3),o.Tb(10,"input",5),o.Xb(),o.Xb(),o.Yb(11,"div",2),o.Yb(12,"mat-form-field",3),o.Tb(13,"textarea",6),o.Xb(),o.Xb(),o.Yb(14,"div",2),o.Yb(15,"mat-form-field",3),o.Tb(16,"textarea",7),o.Xb(),o.Xb(),o.Yb(17,"div",8),o.Yb(18,"mat-form-field",3),o.Tb(19,"textarea",9),o.Xb(),o.Xb(),o.Yb(20,"div",2),o.Yb(21,"mat-form-field",3),o.Tb(22,"input",10),o.Xb(),o.Xb(),o.Yb(23,"div",2),o.Yb(24,"div",3),o.Yb(25,"app-file-browser",11),o.gc("change",(function(t){return e.fileChanged(t)})),o.Xb(),o.Ec(26,w,5,4,"span",12),o.Xb(),o.Xb(),o.Xb(),o.Xb(),o.Yb(27,"app-modal-action"),o.Yb(28,"button",13),o.gc("click",(function(t){return e.submit(t)})),o.Gc(29,"Save"),o.Xb(),o.Xb(),o.Xb()),2&t){var a;const t=null==(a=e.form.get("category_image"))?null:a.value;o.qc("formGroup",e.form),o.Gb(25),o.qc("fileTypes",o.sc(4,Y)),o.Gb(1),o.qc("ngIf",t),o.Gb(2),o.qc("disabled",e._ProgressBarService.inProgress()||e.form.invalid)}},directives:[l.w,l.p,l.i,p.a,h.a,f.b,y.a,l.b,l.o,l.g,v.a,i.m,S.a,C.b,_.a],pipes:[X.a],styles:[""]}),t})();var G=a("R6Eq"),k=a("ZVAu"),T=a("Qu3c");function I(t,e){1&t&&(o.Yb(0,"th",19),o.Gc(1," Category "),o.Xb())}const x=function(t){return{"subcategory-indent":t}};function E(t,e){if(1&t&&(o.Yb(0,"td",20),o.Yb(1,"span",21),o.Gc(2),o.Xb(),o.Xb()),2&t){const t=e.$implicit;o.Gb(1),o.qc("ngClass",o.tc(2,x,!t.isParent)),o.Gb(1),o.Ic(" ",t.categoryname," ")}}function q(t,e){1&t&&(o.Yb(0,"th",19),o.Gc(1," Image "),o.Xb())}function P(t,e){if(1&t&&(o.Yb(0,"td",20),o.Tb(1,"img",22),o.Xb()),2&t){const t=e.$implicit,a=o.kc();o.Gb(1),o.qc("src",a._UploaderService.getImage(t.category_image),o.zc)}}function B(t,e){1&t&&(o.Yb(0,"th",23),o.Gc(1," Description "),o.Xb())}function F(t,e){if(1&t&&(o.Yb(0,"td",20),o.Gc(1),o.Xb()),2&t){const t=e.$implicit;o.Gb(1),o.Ic(" ",t.description," ")}}function N(t,e){1&t&&(o.Yb(0,"th",19),o.Gc(1," Status "),o.Xb())}function R(t,e){if(1&t&&(o.Yb(0,"td",20),o.Gc(1),o.Xb()),2&t){const t=e.$implicit;o.Gb(1),o.Ic(" ",t.status," ")}}function V(t,e){1&t&&(o.Yb(0,"th",24),o.Gc(1," Action "),o.Xb())}function z(t,e){if(1&t){const t=o.Zb();o.Yb(0,"button",28),o.gc("click",(function(){o.yc(t);const e=o.kc().$implicit;return o.kc().addSubcategory(e)})),o.Yb(1,"mat-icon"),o.Gc(2,"add"),o.Xb(),o.Gc(3," Add Subcategory "),o.Xb()}}function M(t,e){if(1&t){const t=o.Zb();o.Yb(0,"td",20),o.Yb(1,"button",25),o.gc("click",(function(){o.yc(t);const a=e.$implicit;return o.kc().edit(a)})),o.Yb(2,"mat-icon"),o.Gc(3,"create"),o.Xb(),o.Gc(4," Edit "),o.Xb(),o.Yb(5,"button",26),o.gc("click",(function(){o.yc(t);const a=e.$implicit;return o.kc().deleteCategory(a)})),o.Yb(6,"mat-icon"),o.Gc(7,"delete"),o.Xb(),o.Gc(8," Delete "),o.Xb(),o.Ec(9,z,4,0,"button",27),o.Xb()}if(2&t){const t=e.$implicit;o.Gb(9),o.qc("ngIf",t.isParent)}}function O(t,e){1&t&&o.Tb(0,"tr",29)}function $(t,e){1&t&&o.Tb(0,"tr",30)}let A=(()=>{class t{constructor(t,e,a,i,r){this._CategoryService=t,this.dialog=e,this._ProgressBarService=a,this._UploaderService=i,this._ToastService=r,this.displayedColumns=["categoryname","category_image","description","status","action"],this.length=0,this.pageSize=10,this.pageSizeOptions=[5,10,25,100]}ngOnInit(){this.dataSource=new s.k([]),this.getCategories()}getCategories(){this._ProgressBarService.show(),this._CategoryService.getNestedCategories().subscribe(t=>{this.length=t.length,this.dataSource.data=t,this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this._ProgressBarService.hide()})}applyFilter(t){this.dataSource.filter=t.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}add(){this.dialog.open(D,{width:"600px",disableClose:!0}).afterClosed().subscribe(t=>{t&&this.getCategories()})}addSubcategory(t){this.dialog.open(D,{width:"600px",disableClose:!0,data:{parent:t}}).afterClosed().subscribe(t=>{t&&this.getCategories()})}edit(t){this.dialog.open(D,{width:"600px",disableClose:!0,data:{category:t}}).afterClosed().subscribe(t=>{t&&this.getCategories()})}deleteCategory(t){this.dialog.open(G.a,{width:"600px",disableClose:!0,data:{message:"Deleting this category. Click Ok to continue."}}).afterClosed().subscribe(e=>{e&&(this._ProgressBarService.show(),this._CategoryService.deleteCategory({id:t.id}).subscribe(t=>{this._ToastService.info(t.message),this.getCategories()}))})}}return t.\u0275fac=function(e){return new(e||t)(o.Sb(b.a),o.Sb(d.b),o.Sb(m.a),o.Sb(g.a),o.Sb(u.a))},t.\u0275cmp=o.Mb({type:t,selectors:[["app-category-list"]],viewQuery:function(t,e){var a;1&t&&(o.Mc(c.a,!0),o.Cc(n.a,!0)),2&t&&(o.vc(a=o.hc())&&(e.paginator=a.first),o.vc(a=o.hc())&&(e.sort=a.first))},decls:26,vars:7,consts:[[1,"row"],[1,"col-xs-6"],[1,"col-xs-6",2,"text-align","right"],["matInput","","placeholder","Search","autocomplete","off",3,"keyup"],["input",""],[1,"table-container","mat-elevation-z8"],["mat-table","",3,"dataSource"],["matColumnDef","categoryname","mat-sort-header",""],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","category_image","mat-sort-header",""],["matColumnDef","description"],["mat-header-cell","","style","width: 300px;",4,"matHeaderCellDef"],["matColumnDef","status"],["matColumnDef","action"],["mat-header-cell","","style","width: 260px;",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageSize","pageSizeOptions","page"],["mat-header-cell",""],["mat-cell",""],[3,"ngClass"],["height","40","appImgFallback","",3,"src"],["mat-header-cell","",2,"width","300px"],["mat-header-cell","",2,"width","260px"],["mat-button","","color","primary","aria-label","Edit Category","matTooltip","Edit this Category",3,"click"],["mat-button","","color","primary","aria-label","Edit Category","matTooltip","Delete this Category",3,"click"],["mat-button","","color","primary","aria-label","Edit Category","matTooltip","Add Subcategory under this category",3,"click",4,"ngIf"],["mat-button","","color","primary","aria-label","Edit Category","matTooltip","Add Subcategory under this category",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(o.Yb(0,"div",0),o.Tb(1,"div",1),o.Yb(2,"div",2),o.Yb(3,"mat-form-field"),o.Yb(4,"input",3,4),o.gc("keyup",(function(t){return e.applyFilter(t)})),o.Xb(),o.Xb(),o.Xb(),o.Xb(),o.Yb(6,"div",5),o.Yb(7,"table",6),o.Wb(8,7),o.Ec(9,I,2,0,"th",8),o.Ec(10,E,3,4,"td",9),o.Vb(),o.Wb(11,10),o.Ec(12,q,2,0,"th",8),o.Ec(13,P,2,1,"td",9),o.Vb(),o.Wb(14,11),o.Ec(15,B,2,0,"th",12),o.Ec(16,F,2,1,"td",9),o.Vb(),o.Wb(17,13),o.Ec(18,N,2,0,"th",8),o.Ec(19,R,2,1,"td",9),o.Vb(),o.Wb(20,14),o.Ec(21,V,2,0,"th",15),o.Ec(22,M,10,1,"td",9),o.Vb(),o.Ec(23,O,1,0,"tr",16),o.Ec(24,$,1,0,"tr",17),o.Xb(),o.Xb(),o.Yb(25,"mat-paginator",18),o.gc("page",(function(t){return e.pageEvent=t})),o.Xb()),2&t&&(o.Gb(7),o.qc("dataSource",e.dataSource),o.Gb(16),o.qc("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),o.Gb(1),o.qc("matRowDefColumns",e.displayedColumns),o.Gb(1),o.qc("length",e.length)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions))},directives:[f.b,y.a,s.j,s.c,s.e,s.b,s.g,s.i,c.a,s.d,s.a,i.k,k.a,C.b,T.a,_.a,i.m,s.f,s.h],styles:[""]}),t})();const H=[{path:"",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Mb({type:t,selectors:[["app-category-management"]],decls:1,vars:0,template:function(t,e){1&t&&o.Tb(0,"app-category-list")},directives:[A],styles:[""]}),t})()}];let j=(()=>{class t{}return t.\u0275mod=o.Qb({type:t}),t.\u0275inj=o.Pb({factory:function(e){return new(e||t)},imports:[[r.e.forChild(H)],r.e]}),t})();var U=a("PCNd");let W=(()=>{class t{}return t.\u0275mod=o.Qb({type:t}),t.\u0275inj=o.Pb({factory:function(e){return new(e||t)},imports:[[i.c,j,U.a.forRoot()]]}),t})()}}]);